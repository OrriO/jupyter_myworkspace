# encoding=utf8


import urllib3
import json
from urllib.parse import quote
import string
import time
url1='http://10.20.105.160:6040/solr/doctor/search?sort=+$is_match+desc,+if(query({!v="recommend_seed:[*+TO+770976]+AND+standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+if(query({!v="recommend_seed:[*+TO+137718]"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url2='http://10.20.105.160:6040/solr/doctor/search?sort=+if(query({!v="recommend_seed:[*+TO+770976]+AND+standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+if(query({!v="recommend_seed:[*+TO+137718]"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url3='http://10.20.105.160:6040/solr/doctor/search?sort=+$is_match+desc,+if(query({!v="standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+if(query({!v="recommend_seed:[*+TO+137718]"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url4='http://10.20.105.160:6040/solr/doctor/search?sort=+$is_match+desc,+if(query({!v="recommend_seed:[*+TO+770976]+AND+standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url5='http://10.20.105.160:6040/solr/doctor/search?sort=+$is_match+desc,+if(query({!v="standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url6='http://10.20.105.160:6040/solr/doctor/search?sort=+if(query({!v="standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url7='http://10.20.105.160:6040/solr/doctor/search?sort=+if(query({!v="recommend_seed:[*+TO+770976]+AND+standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+$is_match+desc,+if(query({!v="recommend_seed:[*+TO+137718]"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url8='http://10.20.105.160:6040/solr/doctor/search?sort=+if(query({!v="standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+$is_match+desc,+if(query({!v="recommend_seed:[*+TO+137718]"}),1,0)+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url9='http://10.20.105.160:6040/solr/doctor/search?sort=+if(query({!v="recommend_seed:[*+TO+770976]+AND+standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+$is_match+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
url10='http://10.20.105.160:6040/solr/doctor/search?sort=+if(query({!v="standard_departments:(7f67c9e4-cff3-11e1-831f-5cf9dd2e7135)"}),1,0)+desc,+$is_match+desc,+random_69531+desc&fq=(*:*+-hospital_uuid:80d5876d-47e0-48b2-9def-dafaa032174b000)&fq=(*:*+-platform_id:LXJUYY)&fq=total_consult_count:[+1+TO+*+]&fq=(consult:2+OR+(hospital_uuid:e051d4fd-c9d8-4eab-b2d5-692855bfe70d000+AND+is_serviceable:1))&fq=include_source:(0+OR+9)&fq=(*:*+-exclude_source:9)&fq=(*:*+-doctor_uuid:(3a63f0fd-2abf-413d-8b33-65e4d17364e2000))&rows=3&qt=/search&fl=consult,doctor_introduction,doctor_name,doctor_photo,doctor_sex,doctor_technical_title,doctor_uuid,feature,pop,score,hospital_department_name,hospital_name,standard_departments,department_uuid,hospital_uuid,doctor_domain,is_image_text,is_phone,is_video,total_consult_count,score,doctor_uuid&is_match=if(max(0,sub(query({!dismax+v="æ³å°¿å¤ç§+å¦äº§ç§+å°¿éç"}),1)),1,0)&start=0&wt=json&version=2.2&q.op=OR&fq_dict=-hospital_uuid&fq_dict=-platform_id&fq_dict=total_consult_count&fq_dict=(consult&fq_dict=include_source&fq_dict=-exclude_source&fq_dict=-doctor_uuid'
http = urllib3.PoolManager()

url={'url1':url1,
'url2':url2,
'url3':url3,
'url4':url4,
'url5':url5,
'url6':url6,
'url7':url7,
'url8':url8,
'url9':url9,
'url10':url10}
for i in url:
    s = quote(url[i], safe=string.printable)
    qtime=0
    cnt=0
    out_time_cnt=0
    for j in range(20000):
        request = http.request('get',s)
        a=json.loads(request.data.decode())
        if a['responseHeader']['QTime'] >10:
            cnt+=1
            qtime+=a['responseHeader']['QTime']
        if a['responseHeader']['QTime'] >100:
            out_time_cnt+=1
        time.sleep(0.0001)
    print(i,out_time_cnt,qtime,cnt,qtime/cnt)

